<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CONFIDENTIAL — Camp Note</title>
<style>
  :root{
    --paper:#f7f3ea;
    --ink:#111;
    --accent:#7b2b2b;
    --redact:#0b0b0b;
    --seal:#5b3b94;
  }
  html,body{height:100%;margin:0;font-family: "Courier New", Courier, monospace;
    background: linear-gradient(180deg,#fbf8f2 0%,#efe8db 100%); color:var(--ink)}
  .wrap{max-width:880px;margin:5vh auto;padding:2rem;background:var(--paper);
       box-shadow:0 12px 30px rgba(10,10,10,0.08);border-left:6px solid rgba(0,0,0,0.06)}
  header{display:flex;gap:1rem;align-items:center;margin-bottom:1rem}
  .seal{width:90px;height:90px;border-radius:50%;display:grid;place-items:center;
        color:var(--seal);font-weight:800;border:3px dashed rgba(91,59,148,0.18);
        transform:rotate(-5deg);font-size:0.75rem;background:linear-gradient(180deg,#fff,#fff0)}
  h1{font-size:1.25rem;margin:0;letter-spacing:0.04em}
  .lead{margin:0.3rem 0;color:#3b3b3b;font-style:italic}
  .meta{display:flex;gap:0.6rem;font-size:0.9rem;color:#444;flex-wrap:wrap}
  .meta div{background:#fff;padding:0.3rem 0.6rem;border-radius:4px;border:1px solid rgba(0,0,0,0.05)}
  .doc{margin-top:1rem;line-height:1.7;font-size:1rem}
  .redacted {display:inline-block;background:var(--redact);color:var(--redact);
             padding:0 0.35rem;border-radius:3px;cursor:pointer;position:relative}
  .hint{font-size:0.9rem;color:#555;margin:0.8rem 0;padding:0.6rem 0.8rem;background:#fff9e6;border-left:4px solid #d4a21a}
  .boxed{background:#fff;padding:1rem;border-left:4px dashed rgba(0,0,0,0.06);margin-top:0.6rem;border-radius:6px}
  .controls{margin-top:1rem;display:flex;gap:0.6rem;flex-wrap:wrap}
  .btn{background:var(--seal);color:#fff;padding:0.45rem 0.8rem;border-radius:4px;border:0;cursor:pointer;
       font-weight:700;letter-spacing:0.02em;box-shadow:0 6px 18px rgba(91,59,148,0.08)}
  .btn.secondary{background:#444}
  .cipher{font-family:monospace;background:#efefef;padding:0.6rem;border-radius:4px;overflow:auto;white-space:pre-wrap;margin-top:1rem}
  footer{margin-top:1.6rem;font-size:0.85rem;color:#666;border-top:1px dashed rgba(0,0,0,0.06);padding-top:0.8rem;display:flex;align-items:center;gap:0.8rem}
  .campaign-tag{display:inline-block;padding:0.25rem 0.6rem;border-radius:3px;border:2px solid var(--seal);color:var(--seal);font-weight:700}
  @media (max-width:520px){.wrap{padding:1rem}.seal{width:68px;height:68px;font-size:0.65rem}}
</style>
</head>
<body>
  <main class="wrap" role="main" aria-labelledby="title">
    <header>
      <div class="seal">WHISPER<br/>LOCK</div>
      <div>
        <h1 id="title">FIELD NOTE — NIGHTFALL ENCLAVE</h1>
        <p class="lead">For the eyes of trusted operatives in the campaign</p>
        <div class="meta">
          <div>Campaign: <strong>Whisper in the Wilds</strong></div>
          <div>Session: <strong><!-- filled by JS --></strong></div>
          <div>DM: <strong>―</strong></div>
        </div>
      </div>
    </header>

    <article class="doc" aria-label="Secret message">
      <p class="hint">A secret note for in-game use. Click any black bar to reveal the hidden lines. This is purely fictional D&amp;D content.</p>

      <div class="boxed" id="message">
        <p><span class="redacted" data-secret="Hi legend,">██████</span></p>

        <p><span class="redacted" data-secret="I absolutely cannot fucking wait for the big attack on the Forest Gnomes.">████████████████████████████████████████████████</span></p>

        <p><span class="redacted" data-secret="Meet me in the sewer pit tonight — go down the old well, cross the turd river (you'll know it when you see it), complete the puzzle (should be pretty easy unless you're useless), and head straight into the pit when it's your turn.">████████████████████████████████████████████████████████████████████████████████████████████</span></p>

        <p><span class="redacted" data-secret="We have to remain anonymous for now. Your fighter number is #4 — I've organized a simple bout against common rats.">████████████████████████████████████████████████████████████</span></p>

        <p><span class="redacted" data-secret="Once you win I'll make sure the referee hands you the plans for the attack along with your payout.">██████████████████████████████████████████████████████</span></p>
      </div>

      <div class="controls" role="group" aria-label="Reveal controls">
        <button class="btn" id="revealAll">Reveal all</button>
        <button class="btn secondary" id="redactAll">Redact</button>
        <button class="btn secondary" id="download">Download note</button>
      </div>

      <div>
        <div class="cipher" id="cipherArea" aria-hidden="true" title="Base64 encoded note"></div>
      </div>

      <footer>
        <span class="campaign-tag">IN-GAME</span>
        <span style="color:#555">Keep this note in-character — it’s meant for tabletop roleplay only.</span>
      </footer>
    </article>
  </main>

<script>
  // fill session
  document.querySelectorAll('.meta strong')[1].textContent = 'Session ' + (new Date()).toLocaleDateString();

  // setup redactions
  const redactedEls = document.querySelectorAll('.redacted');
  redactedEls.forEach(el=>{
    const secret = el.getAttribute('data-secret') || 'REDACTED';
    el.dataset.secret = secret;
    el.dataset.revealed = 'false';
    el.textContent = '████████';
    el.setAttribute('role','button');
    el.setAttribute('aria-pressed','false');
    el.addEventListener('click', ()=> toggleReveal(el));
  });

  function toggleReveal(el){
    if(el.dataset.revealed === 'true'){
      el.textContent = '████████';
      el.dataset.revealed = 'false';
      el.setAttribute('aria-pressed','false');
      el.style.background = 'var(--redact)';
      el.style.color = 'var(--redact)';
    } else {
      el.textContent = el.dataset.secret;
      el.dataset.revealed = 'true';
      el.setAttribute('aria-pressed','true');
      el.style.background = 'transparent';
      el.style.color = 'var(--ink)';
    }
    updateCipher();
  }

  document.getElementById('revealAll').addEventListener('click', ()=>{
    redactedEls.forEach(el=>{
      el.textContent = el.dataset.secret;
      el.dataset.revealed = 'true';
      el.style.background = 'transparent';
      el.style.color = 'var(--ink)';
      el.setAttribute('aria-pressed','true');
    });
    updateCipher();
  });

  document.getElementById('redactAll').addEventListener('click', ()=>{
    redactedEls.forEach(el=>{
      el.textContent = '████████';
      el.dataset.revealed = 'false';
      el.style.background = 'var(--redact)';
      el.style.color = 'var(--redact)';
      el.setAttribute('aria-pressed','false');
    });
    updateCipher();
  });

  function buildPlain(){
    // build a plain version of the note (revealed secrets shown; unrevealed shown as [REDACTED])
    return Array.from(document.querySelectorAll('#message p')).map(p=>{
      const rd = p.querySelector('.redacted');
      if(!rd) return p.textContent.trim();
      return rd.dataset.revealed === 'true' ? rd.dataset.secret : '[REDACTED]';
    }).join('\n\n');
  }

  function updateCipher(){
    const plain = Array.from(document.querySelectorAll('#message p')).map(p=>{
      const rd = p.querySelector('.redacted');
      return rd && rd.dataset.revealed === 'true' ? rd.dataset.secret : '[REDACTED]';
    }).join('\n\n');
    try{
      const enc = btoa(unescape(encodeURIComponent(plain)));
      document.getElementById('cipherArea').textContent = enc;
      document.getElementById('cipherArea').setAttribute('aria-hidden','false');
    } catch(e){
      document.getElementById('cipherArea').textContent = '— encoding error —';
    }
  }

  updateCipher();

  document.getElementById('download').addEventListener('click', ()=>{
    const txt = Array.from(document.querySelectorAll('#message p')).map(p=>{
      const rd = p.querySelector('.redacted');
      return rd && rd.dataset.revealed === 'true' ? rd.dataset.secret : '[REDACTED]';
    }).join('\n\n');
    const blob = new Blob([txt],{type:'text/plain;charset=utf-8'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'camp_note.txt';
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  });
</script>
</body>
</html>
